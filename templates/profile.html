{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2>
            <i class="fas fa-user"></i> –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        </h2>
    </div>
</div>

<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h4 class="mb-0">
                    <i class="fas fa-edit"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
                </h4>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">–ò–º—è *</label>
                            <input type="text" class="form-control" name="name" id="name" 
                                   value="{{ profile.name if profile else '' }}" required
                                   placeholder="–í–∞—à–µ –∏–º—è">
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="age" class="form-label">–í–æ–∑—Ä–∞—Å—Ç *</label>
                            <input type="number" class="form-control" name="age" id="age" 
                                   value="{{ profile.age if profile else '' }}" 
                                   min="1" max="120" required
                                   placeholder="–í–æ–∑—Ä–∞—Å—Ç –≤ –≥–æ–¥–∞—Ö">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="gender" class="form-label">–ü–æ–ª *</label>
                            <select class="form-control" name="gender" id="gender" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                                <option value="male" {{ 'selected' if profile and profile.gender == 'male' else '' }}>
                                    –ú—É–∂—Å–∫–æ–π
                                </option>
                                <option value="female" {{ 'selected' if profile and profile.gender == 'female' else '' }}>
                                    –ñ–µ–Ω—Å–∫–∏–π
                                </option>
                            </select>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="weight" class="form-label">–í–µ—Å (–∫–≥) *</label>
                            <input type="number" class="form-control" name="weight" id="weight" 
                                   value="{{ profile.weight if profile else '' }}" 
                                   step="0.1" min="20" max="300" required
                                   placeholder="–¢–µ–∫—É—â–∏–π –≤–µ—Å">
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="height" class="form-label">–†–æ—Å—Ç (—Å–º) *</label>
                            <input type="number" class="form-control" name="height" id="height" 
                                   value="{{ profile.height if profile else '' }}" 
                                   min="100" max="250" required
                                   placeholder="–†–æ—Å—Ç –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö">
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="activity_level" class="form-label">–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ *</label>
                            <select class="form-control" name="activity_level" id="activity_level" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å</option>
                                <option value="sedentary" {{ 'selected' if profile and profile.activity_level == 'sedentary' else '' }}>
                                    –ú–∞–ª–æ–ø–æ–¥–≤–∏–∂–Ω—ã–π (–æ—Ñ–∏—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
                                </option>
                                <option value="light" {{ 'selected' if profile and profile.activity_level == 'light' else '' }}>
                                    –õ–µ–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (1-3 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –Ω–µ–¥–µ–ª—é)
                                </option>
                                <option value="moderate" {{ 'selected' if profile and profile.activity_level == 'moderate' else '' }}>
                                    –£–º–µ—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (3-5 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é)
                                </option>
                                <option value="active" {{ 'selected' if profile and profile.activity_level == 'active' else '' }}>
                                    –í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (6-7 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≤ –Ω–µ–¥–µ–ª—é)
                                </option>
                                <option value="very_active" {{ 'selected' if profile and profile.activity_level == 'very_active' else '' }}>
                                    –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (2 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ –¥–µ–Ω—å)
                                </option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="goal" class="form-label">–¶–µ–ª—å *</label>
                        <select class="form-control" name="goal" id="goal" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–µ–ª—å</option>
                            <option value="lose" {{ 'selected' if profile and profile.goal == 'lose' else '' }}>
                                üéØ –ü–æ—Ö—É–¥–µ–Ω–∏–µ (–¥–µ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π)
                            </option>
                            <option value="maintain" {{ 'selected' if profile and profile.goal == 'maintain' else '' }}>
                                ‚öñÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–µ—Å–∞
                            </option>
                            <option value="gain" {{ 'selected' if profile and profile.goal == 'gain' else '' }}>
                                üí™ –ù–∞–±–æ—Ä –º–∞—Å—Å—ã (–ø—Ä–æ—Ñ–∏—Ü–∏—Ç –∫–∞–ª–æ—Ä–∏–π)
                            </option>
                        </select>
                    </div>
                    
                    {% if profile and profile.target_calories %}
                    <div class="alert alert-info">
                        <i class="fas fa-calculator"></i>
                        <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –Ω–æ—Ä–º–∞ –∫–∞–ª–æ—Ä–∏–π:</strong> {{ profile.target_calories }} –∫–∫–∞–ª/–¥–µ–Ω—å
                        <br>
                        <small class="text-muted">
                            –†–∞—Å—á–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ñ–æ—Ä–º—É–ª–µ –ú–∏—Ñ—Ñ–ª–∏–Ω–∞-–°–∞–Ω –ñ–µ–æ—Ä–∞ —Å —É—á–µ—Ç–æ–º –≤–∞—à–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–ª–∏.
                        </small>
                    </div>
                    {% endif %}
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-info btn-lg">
                            <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞—Å—á–µ—Ç–∞—Ö -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle"></i> –ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–ª–æ—Ä–∏–∏?
                </h5>
            </div>
            <div class="card-body">
                <p>–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º—É–ª—É –ú–∏—Ñ—Ñ–ª–∏–Ω–∞-–°–∞–Ω –ñ–µ–æ—Ä–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –±–∞–∑–æ–≤–æ–≥–æ –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞:</p>
                
                <div class="row">
                    <div class="col-md-6">
                        <h6>–î–ª—è –º—É–∂—á–∏–Ω:</h6>
                        <code>BMR = 10 √ó –≤–µ—Å + 6.25 √ó —Ä–æ—Å—Ç - 5 √ó –≤–æ–∑—Ä–∞—Å—Ç + 5</code>
                    </div>
                    <div class="col-md-6">
                        <h6>–î–ª—è –∂–µ–Ω—â–∏–Ω:</h6>
                        <code>BMR = 10 √ó –≤–µ—Å + 6.25 √ó —Ä–æ—Å—Ç - 5 √ó –≤–æ–∑—Ä–∞—Å—Ç - 161</code>
                    </div>
                </div>
                
                <p class="mt-3">–ó–∞—Ç–µ–º BMR —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–µ–ª–∏:</p>
                <ul>
                    <li><strong>–ü–æ—Ö—É–¥–µ–Ω–∏–µ:</strong> -500 –∫–∫–∞–ª –æ—Ç TDEE</li>
                    <li><strong>–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ:</strong> TDEE –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π</li>
                    <li><strong>–ù–∞–±–æ—Ä –º–∞—Å—Å—ã:</strong> +500 –∫–∫–∞–ª –∫ TDEE</li>
                </ul>
            </div>
        </div>
        
        {% if profile %}
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-pie"></i> –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3 mb-3">
                        <div class="bg-light p-3 rounded">
                            <h4>{{ "%.1f"|format(profile.weight / ((profile.height/100) ** 2)) }}</h4>
                            <small class="text-muted">–ò–ú–¢</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="bg-light p-3 rounded">
                            <h4>{{ profile.target_calories }}</h4>
                            <small class="text-muted">–∫–∫–∞–ª/–¥–µ–Ω—å</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="bg-light p-3 rounded">
                            <h4>{{ profile.age }}</h4>
                            <small class="text-muted">–ª–µ—Ç</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="bg-light p-3 rounded">
                            <h4>{{ profile.weight }}</h4>
                            <small class="text-muted">–∫–≥</small>
                        </div>
                    </div>
                </div>
                
                {% set bmi = profile.weight / ((profile.height/100) ** 2) %}
                <div class="mt-3">
                    <strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ò–ú–¢:</strong>
                    {% if bmi < 18.5 %}
                        <span class="text-info">–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≤–µ—Å</span>
                    {% elif bmi < 25 %}
                        <span class="text-success">–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–µ—Å</span>
                    {% elif bmi < 30 %}
                        <span class="text-warning">–ò–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å</span>
                    {% else %}
                        <span class="text-danger">–û–∂–∏—Ä–µ–Ω–∏–µ</span>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}