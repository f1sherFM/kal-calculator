{% extends "base.html" %}

{% block content %}
<!-- Hero Section with Animated Background -->
<div class="hero-section mb-5">
    <div class="hero-content text-center">
        <h1 class="hero-title animate-fade-in">
            <i class="fas fa-utensils hero-icon"></i> 
            –î–Ω–µ–≤–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è
        </h1>
        <p class="hero-subtitle animate-fade-in-delay">
            <i class="fas fa-calendar-alt"></i> {{ today.strftime('%d %B %Y') }}
        </p>
        <div class="hero-buttons animate-bounce-in">
            <a href="{{ url_for('add_food') }}" class="btn btn-hero btn-primary btn-lg me-3">
                <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –µ–¥—É
            </a>
            <a href="{{ url_for('products') }}" class="btn btn-hero btn-outline-light btn-lg">
                <i class="fas fa-search"></i> –ù–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç
            </a>
        </div>
    </div>
    <div class="hero-decoration">
        <div class="floating-shapes">
            <div class="shape shape-1">üçé</div>
            <div class="shape shape-2">ü•ó</div>
            <div class="shape shape-3">üçä</div>
            <div class="shape shape-4">ü•ë</div>
            <div class="shape shape-5">üçá</div>
        </div>
    </div>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º -->
<div class="stats-section mb-5">
    <div class="section-header text-center mb-4">
        <h2 class="section-title">
            <i class="fas fa-chart-pie"></i> –î–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        </h2>
        <p class="section-subtitle">–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</p>
    </div>
    
    <div class="row g-4">
        <div class="col-lg-3 col-md-6">
            <div class="stats-card calorie-card animate-slide-up">
                <div class="card-icon">
                    <i class="fas fa-fire"></i>
                </div>
                <div class="card-content">
                    <h3 class="stats-number">{{ "%.0f"|format(total_calories) }}</h3>
                    <p class="stats-label">–ö–∞–ª–æ—Ä–∏–∏</p>
                    <div class="stats-detail">–∏–∑ {{ target_calories }} –∫–∫–∞–ª</div>
                    <div class="progress-ring">
                        {% if target_calories > 0 %}
                            {% set progress_width = [total_calories/target_calories*100, 100]|min %}
                        {% else %}
                            {% set progress_width = 0 %}
                        {% endif %}
                        <div class="progress-bar-modern" data-width="{{ progress_width|round(1) }}"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6">
            <div class="stats-card protein-card animate-slide-up" style="animation-delay: 0.1s">
                <div class="card-icon">
                    <i class="fas fa-dumbbell"></i>
                </div>
                <div class="card-content">
                    <h3 class="stats-number">{{ "%.1f"|format(total_protein) }}</h3>
                    <p class="stats-label">–ë–µ–ª–∫–∏</p>
                    <div class="stats-detail">–≥—Ä–∞–º–º</div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6">
            <div class="stats-card carbs-card animate-slide-up" style="animation-delay: 0.2s">
                <div class="card-icon">
                    <i class="fas fa-bread-slice"></i>
                </div>
                <div class="card-content">
                    <h3 class="stats-number">{{ "%.1f"|format(total_carbs) }}</h3>
                    <p class="stats-label">–£–≥–ª–µ–≤–æ–¥—ã</p>
                    <div class="stats-detail">–≥—Ä–∞–º–º</div>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6">
            <div class="stats-card fat-card animate-slide-up" style="animation-delay: 0.3s">
                <div class="card-icon">
                    <i class="fas fa-tint"></i>
                </div>
                <div class="card-content">
                    <h3 class="stats-number">{{ "%.1f"|format(total_fat) }}</h3>
                    <p class="stats-label">–ñ–∏—Ä—ã</p>
                    <div class="stats-detail">–≥—Ä–∞–º–º</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º -->
<div class="quick-access-section mb-5">
    <div class="section-header text-center mb-4">
        <h2 class="section-title">
            <i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
        </h2>
        <p class="section-subtitle">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ –æ–¥–∏–Ω –∫–ª–∏–∫</p>
    </div>
    
    <div class="quick-products-grid">
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.1s">
            <button class="quick-product-btn" data-product="–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞" data-weight="100">
                <div class="product-emoji">üçó</div>
                <div class="product-name">–ö—É—Ä–∏–Ω–∞—è –≥—Ä—É–¥–∫–∞</div>
                <div class="product-portion">100–≥</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.2s">
            <button class="quick-product-btn" data-product="–†–∏—Å –æ—Ç–≤–∞—Ä–Ω–æ–π" data-weight="150">
                <div class="product-emoji">üçö</div>
                <div class="product-name">–†–∏—Å –æ—Ç–≤–∞—Ä–Ω–æ–π</div>
                <div class="product-portion">150–≥</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.3s">
            <button class="quick-product-btn" data-product="–Ø–±–ª–æ–∫–æ" data-weight="150">
                <div class="product-emoji">üçé</div>
                <div class="product-name">–Ø–±–ª–æ–∫–æ</div>
                <div class="product-portion">150–≥</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.4s">
            <button class="quick-product-btn" data-product="–ú–æ–ª–æ–∫–æ 3.2%" data-weight="200">
                <div class="product-emoji">ü•õ</div>
                <div class="product-name">–ú–æ–ª–æ–∫–æ</div>
                <div class="product-portion">200–º–ª</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.5s">
            <button class="quick-product-btn" data-product="–¢–≤–æ—Ä–æ–≥ 5%" data-weight="100">
                <div class="product-emoji">üßÄ</div>
                <div class="product-name">–¢–≤–æ—Ä–æ–≥</div>
                <div class="product-portion">100–≥</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.6s">
            <button class="quick-product-btn" data-product="–ë–∞–Ω–∞–Ω" data-weight="120">
                <div class="product-emoji">üçå</div>
                <div class="product-name">–ë–∞–Ω–∞–Ω</div>
                <div class="product-portion">120–≥</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.7s">
            <button class="quick-product-btn" data-product="–Ø–π—Ü–æ –∫—É—Ä–∏–Ω–æ–µ" data-weight="60">
                <div class="product-emoji">ü•ö</div>
                <div class="product-name">–Ø–π—Ü–æ</div>
                <div class="product-portion">60–≥</div>
            </button>
        </div>
        
        <div class="quick-product-item animate-scale-in" style="animation-delay: 0.8s">
            <button class="quick-product-btn" data-product="–•–ª–µ–± —á–µ—Ä–Ω—ã–π" data-weight="30">
                <div class="product-emoji">üçû</div>
                <div class="product-name">–•–ª–µ–± —á–µ—Ä–Ω—ã–π</div>
                <div class="product-portion">30–≥</div>
            </button>
        </div>
    </div>
</div>

<!-- –ü—Ä–∏–µ–º—ã –ø–∏—â–∏ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º -->
<div class="meals-section mb-5">
    <div class="section-header text-center mb-4">
        <h2 class="section-title">
            <i class="fas fa-utensils"></i> –ü—Ä–∏–µ–º—ã –ø–∏—â–∏
        </h2>
        <p class="section-subtitle">–í–∞—à —Ä–∞—Ü–∏–æ–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</p>
    </div>
    
    <div class="row g-4">
        {% set meal_config = {
            '–∑–∞–≤—Ç—Ä–∞–∫': {
                'icon': 'fas fa-sun', 
                'emoji': 'üåÖ',
                'color': 'sunrise',
                'time': '7:00-10:00'
            },
            '–æ–±–µ–¥': {
                'icon': 'fas fa-clock', 
                'emoji': '‚òÄÔ∏è',
                'color': 'noon',
                'time': '12:00-15:00'
            },
            '—É–∂–∏–Ω': {
                'icon': 'fas fa-moon', 
                'emoji': 'üåô',
                'color': 'evening',
                'time': '18:00-21:00'
            },
            '–ø–µ—Ä–µ–∫—É—Å': {
                'icon': 'fas fa-cookie-bite', 
                'emoji': 'üç™',
                'color': 'snack',
                'time': '–ª—é–±–æ–µ –≤—Ä–µ–º—è'
            }
        } %}
        
        {% for meal_type, entries in meals.items() %}
        <div class="col-lg-6 col-md-12">
            <div class="meal-card-modern {{ meal_config[meal_type]['color'] }}-meal animate-slide-up" data-animation-delay="{{ (loop.index0 * 0.1)|round(1) }}">
                <div class="meal-header">
                    <div class="meal-icon-wrapper">
                        <span class="meal-emoji">{{ meal_config[meal_type]['emoji'] }}</span>
                        <i class="{{ meal_config[meal_type]['icon'] }} meal-icon"></i>
                    </div>
                    <div class="meal-info">
                        <h3 class="meal-title">{{ meal_type.title() }}</h3>
                        <p class="meal-time">{{ meal_config[meal_type]['time'] }}</p>
                    </div>
                    <div class="meal-calories">
                        {% if entries %}
                            <span class="calories-number">{{ "%.0f"|format(entries|sum(attribute='total_calories')) }}</span>
                            <span class="calories-unit">–∫–∫–∞–ª</span>
                        {% else %}
                            <span class="calories-number">0</span>
                            <span class="calories-unit">–∫–∫–∞–ª</span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="meal-content">
                    {% if entries %}
                        <div class="food-entries">
                            {% for entry in entries %}
                            <div class="food-entry animate-fade-in" data-animation-delay="{{ (loop.index0 * 0.1)|round(1) }}">
                                <div class="food-info">
                                    <h4 class="food-name">{{ entry.product.name }}</h4>
                                    <div class="food-details">
                                        <span class="detail weight">
                                            <i class="fas fa-weight"></i> {{ entry.weight }}–≥
                                        </span>
                                        <span class="detail calories">
                                            <i class="fas fa-fire"></i> {{ "%.0f"|format(entry.total_calories) }} –∫–∫–∞–ª
                                        </span>
                                    </div>
                                    <div class="macros">
                                        <span class="macro protein" title="–ë–µ–ª–∫–∏">
                                            –ë: {{ "%.1f"|format(entry.total_protein) }}–≥
                                        </span>
                                        <span class="macro carbs" title="–£–≥–ª–µ–≤–æ–¥—ã">
                                            –£: {{ "%.1f"|format(entry.total_carbs) }}–≥
                                        </span>
                                        <span class="macro fat" title="–ñ–∏—Ä—ã">
                                            –ñ: {{ "%.1f"|format(entry.total_fat) }}–≥
                                        </span>
                                    </div>
                                </div>
                                <div class="food-actions">
                                    <button class="delete-btn" 
                                            data-entry-id="{{ entry.id }}"
                                            data-product-name="{{ entry.product.name }}"
                                            onclick="confirmDelete(this.dataset.entryId, this.dataset.productName)"
                                            title="–£–¥–∞–ª–∏—Ç—å">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="empty-meal">
                            <div class="empty-icon">
                                <i class="fas fa-utensils"></i>
                            </div>
                            <p class="empty-text">–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ</p>
                            <a href="{{ url_for('add_food') }}" class="add-food-btn">
                                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –µ–¥—É
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞–ª–æ—Ä–∏—è–º —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º -->
{% if total_calories > 0 or target_calories > 0 %}
<div class="progress-section mb-5">
    <div class="progress-card">
        <div class="progress-header">
            <div class="progress-title">
                <i class="fas fa-target"></i>
                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞–ª–æ—Ä–∏—è–º</span>
            </div>
            <div class="progress-stats">
                <span class="current">{{ "%.0f"|format(total_calories) }}</span>
                <span class="separator">/</span>
                <span class="target">{{ target_calories }}</span>
                <span class="unit">–∫–∫–∞–ª</span>
            </div>
        </div>
        
        <div class="progress-visual">
            {% if target_calories > 0 %}
                {% set progress_percent = [total_calories/target_calories*100, 100]|min %}
            {% else %}
                {% set progress_percent = 0 %}
            {% endif %}
            
            <div class="progress-ring-container">
                <svg class="progress-ring" width="200" height="200">
                    <circle class="progress-ring-circle-bg" cx="100" cy="100" r="80"></circle>
                    <circle class="progress-ring-circle" cx="100" cy="100" r="80" 
                            data-progress="{{ progress_percent|round(1) }}"></circle>
                </svg>
                <div class="progress-ring-text">
                    <span class="percentage">{{ "%.0f"|format(progress_percent) }}%</span>
                    <span class="label">–≤—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
                </div>
            </div>
            
            <div class="progress-details">
                {% if total_calories > target_calories %}
                    <div class="progress-message warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –Ω–∞ {{ "%.0f"|format(total_calories - target_calories) }} –∫–∫–∞–ª</span>
                    </div>
                {% elif total_calories < target_calories * 0.8 %}
                    <div class="progress-message info">
                        <i class="fas fa-info-circle"></i>
                        <span>–û—Å—Ç–∞–ª–æ—Å—å {{ "%.0f"|format(target_calories - total_calories) }} –∫–∫–∞–ª</span>
                    </div>
                {% else %}
                    <div class="progress-message success">
                        <i class="fas fa-check-circle"></i>
                        <span>–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å!</span>
                    </div>
                {% endif %}
                
                <div class="daily-summary">
                    <div class="summary-item">
                        <span class="label">–¶–µ–ª—å –Ω–∞ –¥–µ–Ω—å:</span>
                        <span class="value">{{ target_calories }} –∫–∫–∞–ª</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–æ:</span>
                        <span class="value">{{ "%.0f"|format(total_calories) }} –∫–∫–∞–ª</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<style>
/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã */

/* Hero Section */
.hero-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 20px;
    padding: 60px 30px;
    position: relative;
    overflow: hidden;
    color: white;
    margin-bottom: 40px;
}

.hero-content {
    position: relative;
    z-index: 2;
}

.hero-title {
    font-size: 3.5rem;
    font-weight: 700;
    margin-bottom: 15px;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.hero-icon {
    font-size: 4rem;
    margin-right: 20px;
    animation: pulse 2s infinite;
}

.hero-subtitle {
    font-size: 1.3rem;
    opacity: 0.9;
    margin-bottom: 30px;
}

.hero-buttons {
    margin-top: 30px;
}

.btn-hero {
    padding: 15px 30px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 50px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    transition: all 0.3s ease;
    margin: 5px;
}

.btn-hero:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
}

/* –ü–ª–∞–≤–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã */
.floating-shapes {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    overflow: hidden;
    pointer-events: none;
}

.shape {
    position: absolute;
    font-size: 2rem;
    opacity: 0.6;
    animation: float 6s ease-in-out infinite;
}

.shape-1 { top: 20%; left: 10%; animation-delay: 0s; }
.shape-2 { top: 60%; left: 20%; animation-delay: -2s; }
.shape-3 { top: 30%; right: 15%; animation-delay: -4s; }
.shape-4 { top: 70%; right: 25%; animation-delay: -1s; }
.shape-5 { top: 45%; right: 5%; animation-delay: -3s; }

/* –°–µ–∫—Ü–∏–∏ */
.section-header {
    margin-bottom: 40px;
}

.section-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 10px;
}

.section-subtitle {
    font-size: 1.1rem;
    color: #7f8c8d;
    margin: 0;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
.stats-card {
    background: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    border: none;
    height: 100%;
    position: relative;
    overflow: hidden;
    opacity: 0;
    transform: translateY(50px);
}

.stats-card.animate-loaded {
    opacity: 1;
    transform: translateY(0);
}

.stats-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, var(--card-color-1), var(--card-color-2));
}

.stats-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.calorie-card {
    --card-color-1: #667eea;
    --card-color-2: #764ba2;
}

.protein-card {
    --card-color-1: #f093fb;
    --card-color-2: #f5576c;
}

.carbs-card {
    --card-color-1: #4facfe;
    --card-color-2: #00f2fe;
}

.fat-card {
    --card-color-1: #43e97b;
    --card-color-2: #38f9d7;
}

.card-icon {
    font-size: 3rem;
    background: linear-gradient(135deg, var(--card-color-1), var(--card-color-2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 15px;
}

.stats-number {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 10px 0;
    color: #2c3e50;
}

.stats-label {
    font-size: 1.1rem;
    font-weight: 600;
    color: #7f8c8d;
    margin: 0;
}

.stats-detail {
    font-size: 0.9rem;
    color: #95a5a6;
    margin-top: 5px;
}

.progress-bar-modern {
    height: 6px;
    background: linear-gradient(90deg, var(--card-color-1), var(--card-color-2));
    border-radius: 10px;
    margin-top: 15px;
    width: 0%;
    transition: width 1.5s ease;
}

/* –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø */
.quick-products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 20px;
    padding: 0;
}

.quick-product-item {
    position: relative;
}

.quick-product-btn {
    width: 100%;
    background: white;
    border: 2px solid #e3f2fd;
    border-radius: 15px;
    padding: 20px 15px;
    transition: all 0.3s ease;
    cursor: pointer;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
}

.quick-product-btn:hover {
    transform: translateY(-3px);
    border-color: #2196f3;
    box-shadow: 0 10px 25px rgba(33, 150, 243, 0.15);
}

.product-emoji {
    font-size: 2.5rem;
    margin-bottom: 10px;
    display: block;
}

.product-name {
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 5px;
    font-size: 0.9rem;
}

.product-portion {
    color: #7f8c8d;
    font-size: 0.8rem;
}

/* –ö–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏ */
.meal-card-modern {
    background: white;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    overflow: hidden;
    transition: all 0.3s ease;
    position: relative;
    opacity: 0;
    transform: translateY(50px);
}

.meal-card-modern.animate-loaded {
    opacity: 1;
    transform: translateY(0);
}

.meal-card-modern:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.meal-header {
    padding: 25px;
    background: linear-gradient(135deg, var(--meal-color-1), var(--meal-color-2));
    color: white;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.sunrise-meal {
    --meal-color-1: #ffecd2;
    --meal-color-2: #fcb69f;
    color: #8b4513 !important;
}

.noon-meal {
    --meal-color-1: #a8edea;
    --meal-color-2: #fed6e3;
    color: #2c3e50 !important;
}

.evening-meal {
    --meal-color-1: #667eea;
    --meal-color-2: #764ba2;
}

.snack-meal {
    --meal-color-1: #ffecd2;
    --meal-color-2: #fcb69f;
    color: #d35400 !important;
}

.meal-icon-wrapper {
    display: flex;
    align-items: center;
    margin-right: 15px;
}

.meal-emoji {
    font-size: 2rem;
    margin-right: 10px;
}

.meal-icon {
    font-size: 1.5rem;
    opacity: 0.8;
}

.meal-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0;
}

.meal-time {
    font-size: 0.9rem;
    opacity: 0.8;
    margin: 0;
}

.meal-calories {
    text-align: right;
}

.calories-number {
    font-size: 2rem;
    font-weight: 700;
    display: block;
}

.calories-unit {
    font-size: 0.9rem;
    opacity: 0.8;
}

.meal-content {
    padding: 25px;
}

/* Food entries spacing handled by margin-bottom on .food-entry */

.food-entry {
    background: #f8f9fa;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: all 0.3s ease;
}

.food-entry:hover {
    background: #e9ecef;
    transform: translateX(5px);
}

.food-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: #2c3e50;
    margin: 0 0 8px 0;
}

.food-details {
    margin-bottom: 8px;
}

.detail {
    display: inline-block;
    margin-right: 15px;
    font-size: 0.9rem;
    color: #7f8c8d;
}

.detail i {
    margin-right: 5px;
    width: 12px;
}

.macros {
    display: flex;
    gap: 10px;
}

.macro {
    background: rgba(108, 117, 125, 0.1);
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 0.75rem;
    color: #6c757d;
}

.delete-btn {
    background: #dc3545;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.delete-btn:hover {
    background: #c82333;
    transform: scale(1.05);
}

.empty-meal {
    text-align: center;
    padding: 40px 20px;
    color: #6c757d;
}

.empty-icon {
    font-size: 3rem;
    margin-bottom: 15px;
    opacity: 0.5;
}

.empty-text {
    font-size: 1.1rem;
    margin-bottom: 20px;
}

.add-food-btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 25px;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
}

.add-food-btn:hover {
    background: #0056b3;
    color: white;
    text-decoration: none;
    transform: translateY(-2px);
}

/* –ü—Ä–æ–≥—Ä–µ—Å—Å */
.progress-card {
    background: white;
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    text-align: center;
}

.progress-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.progress-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.5rem;
    font-weight: 700;
    color: #2c3e50;
}

.progress-stats {
    font-size: 1.2rem;
}

.current {
    font-weight: 700;
    color: #007bff;
}

.target {
    color: #6c757d;
}

.progress-visual {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 40px;
}

.progress-ring-container {
    position: relative;
}

.progress-ring {
    transform: rotate(-90deg);
}

.progress-ring-circle-bg {
    fill: none;
    stroke: #e9ecef;
    stroke-width: 8;
}

.progress-ring-circle {
    fill: none;
    stroke: #007bff;
    stroke-width: 8;
    stroke-linecap: round;
    stroke-dasharray: 502.65;
    stroke-dashoffset: 502.65;
    transition: stroke-dashoffset 1.5s ease;
}

.progress-ring-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.percentage {
    font-size: 2rem;
    font-weight: 700;
    color: #2c3e50;
    display: block;
}

.label {
    font-size: 0.9rem;
    color: #7f8c8d;
}

.progress-details {
    flex: 1;
}

.progress-message {
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.progress-message.warning {
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeaa7;
}

.progress-message.info {
    background: #d1ecf1;
    color: #0c5460;
    border: 1px solid #bee5eb;
}

.progress-message.success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.daily-summary {
    text-align: left;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    padding: 8px 0;
    border-bottom: 1px solid #e9ecef;
}

.summary-item:last-child {
    border-bottom: none;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(50px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes scaleIn {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
}

@keyframes bounceIn {
    0% { opacity: 0; transform: scale(0.3); }
    50% { opacity: 1; transform: scale(1.05); }
    70% { transform: scale(0.9); }
    100% { opacity: 1; transform: scale(1); }
}

.animate-fade-in {
    animation: fadeIn 1s ease forwards;
}

.animate-fade-in-delay {
    animation: fadeIn 1s ease 0.3s forwards;
    opacity: 0;
}

.animate-bounce-in {
    animation: bounceIn 1s ease 0.6s forwards;
    opacity: 0;
}

.animate-slide-up {
    animation: slideUp 0.8s ease forwards;
}

.animate-scale-in {
    animation: scaleIn 0.6s ease forwards;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
    .hero-title {
        font-size: 2.5rem;
    }
    
    .hero-icon {
        font-size: 3rem;
    }
    
    .section-title {
        font-size: 2rem;
    }
    
    .quick-products-grid {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
    }
    
    .progress-visual {
        flex-direction: column;
        gap: 20px;
    }
    
    .meal-header {
        flex-direction: column;
        text-align: center;
        gap: 15px;
    }
    
    .progress-header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }
}
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    animateOnLoad();
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
    animateProgressBars();
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –∫—Ä—É–≥–æ–≤—ã—Ö –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
    animateProgressRings();
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
    setupQuickAddButtons();
    
    // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π
    setupDeleteConfirmation();
});

function animateOnLoad() {
    // Apply animation delays from data attributes
    applyAnimationDelays();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    const statsCards = document.querySelectorAll('.stats-card');
    statsCards.forEach((card, index) => {
        setTimeout(() => {
            card.classList.add('animate-loaded');
        }, index * 150);
    });
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –ø—Ä–∏–µ–º–æ–≤ –ø–∏—â–∏
    const mealCards = document.querySelectorAll('.meal-card-modern');
    mealCards.forEach((card, index) => {
        setTimeout(() => {
            card.classList.add('animate-loaded');
        }, (index + statsCards.length) * 150 + 600);
    });
}

function applyAnimationDelays() {
    // Apply animation delays to elements with data-animation-delay attribute
    const elementsWithDelays = document.querySelectorAll('[data-animation-delay]');
    elementsWithDelays.forEach(element => {
        const delay = parseFloat(element.getAttribute('data-animation-delay'));
        if (!isNaN(delay)) {
            element.style.animationDelay = delay + 's';
        }
    });
}

function animateProgressBars() {
    const progressBars = document.querySelectorAll('.progress-bar-modern[data-width]');
    
    setTimeout(() => {
        progressBars.forEach((bar, index) => {
            setTimeout(() => {
                const width = bar.getAttribute('data-width');
                bar.style.width = width + '%';
            }, index * 200);
        });
    }, 500);
}

function animateProgressRings() {
    const progressRings = document.querySelectorAll('.progress-ring-circle[data-progress]');
    
    setTimeout(() => {
        progressRings.forEach((ring, index) => {
            setTimeout(() => {
                const progress = parseFloat(ring.getAttribute('data-progress'));
                const circumference = 502.65; // 2 * œÄ * 80
                const offset = circumference - (progress / 100) * circumference;
                ring.style.strokeDashoffset = offset;
                
                // –ê–Ω–∏–º–∞—Ü–∏—è —Ü–≤–µ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                if (progress > 100) {
                    ring.style.stroke = '#e74c3c'; // –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è
                } else if (progress > 80) {
                    ring.style.stroke = '#27ae60'; // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                } else if (progress > 50) {
                    ring.style.stroke = '#f39c12'; // –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                } else {
                    ring.style.stroke = '#3498db'; // –°–∏–Ω–∏–π –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                }
            }, index * 300);
        });
    }, 800);
}

function setupQuickAddButtons() {
    const quickAddButtons = document.querySelectorAll('.quick-product-btn');
    
    quickAddButtons.forEach(button => {
        button.addEventListener('click', function() {
            const productName = this.dataset.product;
            const weight = this.dataset.weight;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 150);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–µ–º–∞ –ø–∏—â–∏
            showMealTypeModal(productName, weight);
        });
        
        // –î–æ–±–∞–≤–ª—è–µ–º hover —ç—Ñ—Ñ–µ–∫—Ç—ã
        button.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-3px) scale(1.02)';
        });
        
        button.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });
}

function setupDeleteConfirmation() {
    const deleteButtons = document.querySelectorAll('.delete-btn');
    
    deleteButtons.forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault();
            
            const entryId = this.dataset.entryId;
            const productName = this.dataset.productName;
            
            showDeleteConfirmation(entryId, productName);
        });
    });
}

function showMealTypeModal(productName, weight) {
    const modalHtml = `
        <div class="modal fade" id="quickAddModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title">
                            <i class="fas fa-plus-circle me-2"></i>
                            –î–æ–±–∞–≤–∏—Ç—å ${productName}
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4">
                        <div class="text-center mb-4">
                            <div class="product-preview">
                                <span class="product-emoji">üçΩÔ∏è</span>
                                <h6 class="mt-2 mb-0">${productName}</h6>
                                <small class="text-muted">–í–µ—Å: <strong>${weight}–≥</strong></small>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label fw-semibold">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–µ–º –ø–∏—â–∏:</label>
                            <div class="meal-options">
                                <div class="row g-2">
                                    <div class="col-6">
                                        <input type="radio" class="btn-check" name="meal-type" id="meal-breakfast" value="–∑–∞–≤—Ç—Ä–∞–∫" checked>
                                        <label class="btn btn-outline-warning w-100 meal-option-btn" for="meal-breakfast">
                                            <span class="meal-emoji">üåÖ</span>
                                            <br><small>–ó–∞–≤—Ç—Ä–∞–∫</small>
                                        </label>
                                    </div>
                                    <div class="col-6">
                                        <input type="radio" class="btn-check" name="meal-type" id="meal-lunch" value="–æ–±–µ–¥">
                                        <label class="btn btn-outline-info w-100 meal-option-btn" for="meal-lunch">
                                            <span class="meal-emoji">‚òÄÔ∏è</span>
                                            <br><small>–û–±–µ–¥</small>
                                        </label>
                                    </div>
                                    <div class="col-6">
                                        <input type="radio" class="btn-check" name="meal-type" id="meal-dinner" value="—É–∂–∏–Ω">
                                        <label class="btn btn-outline-primary w-100 meal-option-btn" for="meal-dinner">
                                            <span class="meal-emoji">üåô</span>
                                            <br><small>–£–∂–∏–Ω</small>
                                        </label>
                                    </div>
                                    <div class="col-6">
                                        <input type="radio" class="btn-check" name="meal-type" id="meal-snack" value="–ø–µ—Ä–µ–∫—É—Å">
                                        <label class="btn btn-outline-success w-100 meal-option-btn" for="meal-snack">
                                            <span class="meal-emoji">üç™</span>
                                            <br><small>–ü–µ—Ä–µ–∫—É—Å</small>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i>–û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="button" class="btn btn-primary" onclick="quickAddProduct('${productName}', ${weight})">
                            <i class="fas fa-check me-1"></i>–î–æ–±–∞–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ—Å–ª–∏ –µ—Å—Ç—å
    const existingModal = document.getElementById('quickAddModal');
    if (existingModal) {
        existingModal.remove();
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    document.body.insertAdjacentHTML('beforeend', modalHtml);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
    const modal = new bootstrap.Modal(document.getElementById('quickAddModal'));
    modal.show();
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    const style = document.createElement('style');
    style.textContent = `
        .product-preview {
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            margin-bottom: 20px;
        }
        
        .product-preview .product-emoji {
            font-size: 3rem;
            display: block;
            margin-bottom: 10px;
        }
        
        .meal-option-btn {
            padding: 15px 10px;
            height: 80px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border-width: 2px;
        }
        
        .meal-option-btn .meal-emoji {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .meal-option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .btn-check:checked + .meal-option-btn {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
    `;
    
    document.head.appendChild(style);
}

function quickAddProduct(productName, weight) {
    const selectedMealType = document.querySelector('input[name="meal-type"]:checked');
    
    if (!selectedMealType) {
        showEnhancedNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–µ–º –ø–∏—â–∏', 'warning');
        return;
    }
    
    const mealType = selectedMealType.value;
    const today = new Date().toISOString().split('T')[0];
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    const addButton = document.querySelector('#quickAddModal .btn-primary');
    const originalText = addButton.innerHTML;
    addButton.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>–î–æ–±–∞–≤–ª—è–µ–º...';
    addButton.disabled = true;
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST –∑–∞–ø—Ä–æ—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞
    fetch('/api/quick_add_food?' + new URLSearchParams({_t: Date.now()}), {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            product_name: productName,
            weight: weight,
            meal_type: mealType,
            date: today
        })
    })
    .then(response => response.json())
    .then(data => {
        addButton.innerHTML = originalText;
        addButton.disabled = false;
        
        if (data.success) {
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            bootstrap.Modal.getInstance(document.getElementById('quickAddModal')).hide();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
            showEnhancedNotification(
                `‚úÖ ${productName} (${weight}–≥) –¥–æ–±–∞–≤–ª–µ–Ω –≤ ${mealType}!`, 
                'success'
            );
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
            confettiAnimation();
            
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å cache-busting —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                const url = new URL(window.location.href);
                url.searchParams.set('_t', Date.now());
                window.location.href = url.toString();
            }, 1500);
        } else {
            showEnhancedNotification('‚ùå –û—à–∏–±–∫–∞: ' + data.message, 'error');
        }
    })
    .catch(error => {
        addButton.innerHTML = originalText;
        addButton.disabled = false;
        
        console.error('–û—à–∏–±–∫–∞:', error);
        showEnhancedNotification('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞', 'error');
    });
}

function showDeleteConfirmation(entryId, productName) {
    const modalHtml = `
        <div class="modal fade" id="deleteConfirmModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-4 text-center">
                        <div class="mb-3">
                            <i class="fas fa-trash-alt text-danger" style="font-size: 3rem;"></i>
                        </div>
                        <h6>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å?</h6>
                        <p class="text-muted mb-0">
                            <strong>${productName}</strong>
                        </p>
                        <small class="text-muted">–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å</small>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-light" data-bs-dismiss="modal">
                            <i class="fas fa-times me-1"></i>–û—Ç–º–µ–Ω–∞
                        </button>
                        <button type="button" class="btn btn-danger" onclick="confirmDeleteEntry(${entryId})">
                            <i class="fas fa-trash me-1"></i>–£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ—Å–ª–∏ –µ—Å—Ç—å
    const existingModal = document.getElementById('deleteConfirmModal');
    if (existingModal) {
        existingModal.remove();
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    document.body.insertAdjacentHTML('beforeend', modalHtml);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    const modal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));
    modal.show();
}

function confirmDeleteEntry(entryId) {
    const deleteButton = document.querySelector('#deleteConfirmModal .btn-danger');
    const originalText = deleteButton.innerHTML;
    
    deleteButton.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>–£–¥–∞–ª—è–µ–º...';
    deleteButton.disabled = true;
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
    fetch(`/delete_food_entry/${entryId}`, {
        method: 'POST',
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => {
        if (response.ok) {
            bootstrap.Modal.getInstance(document.getElementById('deleteConfirmModal')).hide();
            showEnhancedNotification('‚úÖ –ó–∞–ø–∏—Å—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞!', 'success');
            
            setTimeout(() => {
                const url = new URL(window.location.href);
                url.searchParams.set('_t', Date.now());
                window.location.href = url.toString();
            }, 1000);
        } else {
            throw new Error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è');
        }
    })
    .catch(error => {
        deleteButton.innerHTML = originalText;
        deleteButton.disabled = false;
        showEnhancedNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏', 'error');
    });
}

function showEnhancedNotification(message, type) {
    const alertClass = {
        'success': 'alert-success',
        'error': 'alert-danger',
        'warning': 'alert-warning',
        'info': 'alert-info'
    }[type] || 'alert-info';
    
    const icon = {
        'success': 'fas fa-check-circle',
        'error': 'fas fa-exclamation-circle',
        'warning': 'fas fa-exclamation-triangle',
        'info': 'fas fa-info-circle'
    }[type] || 'fas fa-info-circle';
    
    const notification = document.createElement('div');
    notification.className = `alert ${alertClass} alert-dismissible fade show position-fixed notification-modern`;
    notification.style.cssText = `
        top: 20px;
        right: 20px;
        z-index: 9999;
        min-width: 350px;
        max-width: 500px;
        border: none;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        animation: slideInRight 0.5s ease;
    `;
    
    notification.innerHTML = `
        <div class="d-flex align-items-center">
            <i class="${icon} me-3" style="font-size: 1.2rem;"></i>
            <div class="flex-grow-1">${message}</div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" style="margin-left: 15px;"></button>
        </div>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
    if (!document.getElementById('notification-styles')) {
        const style = document.createElement('style');
        style.id = 'notification-styles';
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
            
            .notification-modern {
                backdrop-filter: blur(10px);
                border-left: 4px solid currentColor;
            }
        `;
        document.head.appendChild(style);
    }
    
    document.body.appendChild(notification);
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        if (notification.parentNode) {
            notification.style.animation = 'slideOutRight 0.5s ease';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 500);
        }
    }, 4000);
}

function confettiAnimation() {
    // –ü—Ä–æ—Å—Ç–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
    const confettiContainer = document.createElement('div');
    confettiContainer.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 10000;
    `;
    
    const emojis = ['üéâ', 'üéÜ', '‚ú®', 'üåà', 'üéÅ'];
    
    for (let i = 0; i < 20; i++) {
        const confetti = document.createElement('div');
        confetti.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        confetti.style.cssText = `
            position: absolute;
            font-size: ${Math.random() * 20 + 20}px;
            left: ${Math.random() * 100}%;
            top: -50px;
            animation: confettiFall ${Math.random() * 2 + 2}s linear;
        `;
        
        confettiContainer.appendChild(confetti);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
    if (!document.getElementById('confetti-styles')) {
        const style = document.createElement('style');
        style.id = 'confetti-styles';
        style.textContent = `
            @keyframes confettiFall {
                to {
                    transform: translateY(100vh) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    }
    
    document.body.appendChild(confettiContainer);
    
    // –£–¥–∞–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        confettiContainer.remove();
    }, 3000);
}

// –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
function confirmDelete(entryId, productName) {
    showDeleteConfirmation(entryId, productName);
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ scroll –∞–Ω–∏–º–∞—Ü–∏–π
window.addEventListener('scroll', function() {
    const scrolled = window.pageYOffset;
    const parallax = document.querySelector('.floating-shapes');
    
    if (parallax) {
        parallax.style.transform = `translateY(${scrolled * 0.2}px)`;
    }
    
    // –ü–æ—è–≤–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ
    const animateElements = document.querySelectorAll('.animate-on-scroll');
    animateElements.forEach(element => {
        const elementTop = element.offsetTop;
        const elementHeight = element.offsetHeight;
        const windowHeight = window.innerHeight;
        
        if (scrolled + windowHeight > elementTop + elementHeight / 3) {
            element.classList.add('animated');
        }
    });
});

function showNotification(message, type) {
    showEnhancedNotification(message, type);
}
</script>
{% endblock %}